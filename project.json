{
    "$schema": "http://json-schema.org/schema#",
    "$id": "https://raw.githubusercontent.com/myhumankit/myworkshop/master/schemas/project.json",
    "title": "JSON SCHEMA for My Workshop projects",
    "description": "This is a JSON SCHEMA for the documentation generator My Workshop",
    "definitions": {
        "url": {
            "title": "URL",
            "description": "Relative or absolute URL.",
            "type": "string"
        },
        "slug": {
            "title": "Slug",
            "description": "The file name of the JSON (without extension).",
            "type": "string"
        },
        "github_organization": {
            "title": "GitHub organization",
            "type": "string"
        },
        "github_repository": {
            "title": "GitHub repository",
            "type": "string"
        },
        "image": {
            "title": "Image",
            "type": "object",
            "required": ["image"],
            "additionalProperties": false,
            "properties": {
                "image": {
                    "title": "Image",
                    "description": "Link to a picture.",
                    "type": "object",
                    "required": ["url", "caption"],
                    "additionalProperties": false,
                    "properties": {
                        "url": {
                            "$ref": "#/definitions/url"
                        },
                        "caption": {
                            "title": "Caption",
                            "description": "Legend of the image.",
                            "type": "string"
                        }
                    }
                }
            }
        },
        "youtube": {
            "title": "Youtube",
            "type": "object",
            "required": ["youtube"],
            "additionalProperties": false,
            "properties": {
                "youtube": {
                    "title": "Youtube",
                    "description": "Embedded YouTube video.",
                    "type": "object",
                    "required": ["id", "caption"],
                    "additionalProperties": false,
                    "properties": {
                        "id": {
                            "title": "YouTube video Id",
                            "description": "The end of the URL video",
                            "type": "string"
                        },
                        "caption": {
                            "title": "Caption",
                            "description": "Legend of the video.",
                            "type": "string"
                        }
                    }
                }
            }
        },
        "link": {
            "title": "Link",
            "description": "Link to a website, etc.",
            "type": "object",
            "required": ["url", "text"],
            "properties": {
                "url": {
                    "$ref": "#/definitions/url"
                },
                "text": {
                    "title": "Text",
                    "description": "Visible part of the link.",
                    "type": "string"
                },
                "fa5_icon": {
                    "title": "Icon",
                    "title": "Font Awesome 5 icon class.",
                    "type": "string",
                    "default": "fas fa-link"
                }
            }
        },
        "user": {
            "title": "User",
            "description": "A physical person.",
            "type": "object",
            "required": ["full_name"],
            "properties": {
                "full_name": {
                    "title": "Full name",
                    "type": "string"
                },
                "email": {
                    "title": "email",
                    "format": "email",
                    "type": "string"
                },
                "github_username": {
                    "title": "GitHub username",
                    "type": "string"
                },
                "twitter_username": {
                    "title": "Twitter username",
                    "type": "string"
                },
                "role": {
                    "title": "Role",
                    "description": "User's role in a project.",
                    "type": "string",
                    "enum": ["Porteur de projet", "Animateur", "Fabmanager référent", "Contributeur", "Responsable de la documentation"]
                }
            }
        },
        "paragraph": {
            "title": "Paragraph",
            "description": "A textarea written in Markdown.",
            "type": "string",
            "format": "markdown"
        },
        "alert": {
            "title": "Alert",
            "description": "An alert message!",
            "type": "object",
            "required": ["class", "message"],
            "additionalProperties": false,
            "properties": {
                "class": {
                    "title": "Class",
                    "description": "Class of the alert message.",
                    "type": "string",
                    "enum": ["success", "danger", "warning", "info"]
                },
                "message": {
                    "title": "Message",
                    "description": "Content of the alert message.",
                    "type": "string",
                    "format": "textarea"
                }
            }
        },
        "file": {
            "title": "File",
            "type": "object",
            "required": ["file"],
            "additionalProperties": false,
            "properties": {
                "file": {
                    "title": "File",
                    "description": "A required file, 3D model, source code, etc.",
                    "type": "object",
                    "required": ["name", "url"],
                    "additionalProperties": false,
                    "properties": {
                        "name": {
                            "title": "Name",
                            "type": "string"
                        },
                        "url": { "$ref": "#/definitions/url" }
                    }
                }
            }
        },
        "component": {
            "title": "Component",
            "type": "object",
            "required": ["component"],
            "additionalProperties": false,
            "properties": {
                "component": {
                    "title": "Component",
                    "description": "Component.",
                    "type": "object",
                    "oneOf": [
                        {
                            "title": "Local component",
                            "required": ["slug", "quantity"],
                            "additionalProperties": false,
                            "properties": {
                                "slug": { "$ref": "#/definitions/slug" },
                                "quantity": {
                                    "title": "Quantity",
                                    "type": "number",
                                    "default": 1,
                                    "minimum": 0
                                }
                            }
                        },
                        {
                            "title": "External component",
                            "required": ["slug", "quantity", "github_organization", "github_repository"],
                            "additionalProperties": false,
                            "properties": {
                                "slug": { "$ref": "#/definitions/slug" },
                                "quantity": {
                                    "title": "Quantity",
                                    "type": "number",
                                    "default": 1,
                                    "minimum": 0
                                },
                                "github_organization": { "$ref": "#/definitions/github_organization" },
                                "github_repository": { "$ref": "#/definitions/github_repository" }
                            }
                        }
                    ]
                }
            }
        },
        "tool": {
            "title": "Tool",
            "type": "object",
            "required": ["tool"],
            "additionalProperties": false,
            "properties": {
                "tool": {
                    "title": "Tool",
                    "description": "Tool.",
                    "type": "object",
                    "oneOf": [
                        {
                            "title": "Local tool",
                            "required": ["slug"],
                            "additionalProperties": false,
                            "properties": {
                                "slug": { "$ref": "#/definitions/slug" }
                            }
                        },
                        {
                            "title": "External tool",
                            "required": ["slug", "github_organization", "github_repository"],
                            "additionalProperties": false,
                            "properties": {
                                "slug": { "$ref": "#/definitions/slug" },
                                "github_organization": { "$ref": "#/definitions/github_organization" },
                                "github_repository": { "$ref": "#/definitions/github_repository" }
                            }
                        }
                    ]
                }
            }
        },
        "step": {
            "title": "Step",
            "description": "Describe a step of the tutorial.",
            "type": "object",
            "required": ["title", "duration", "content"],
            "properties": {
                "title": {
                    "title": "Title",
                    "type": "string"
                },
                "duration": {
                    "title": "Duration",
                    "description": "Estimated duration of a step (seconds).",
                    "type": "integer",
                    "default": 300
                },
                "content": {
                    "title": "Content",
                    "$ref": "#/definitions/paragraph"
                },
                "alerts": {
                    "title": "Alerts",
                    "type": "array",
                    "minItems": 1,
                    "items": { "$ref": "#/definitions/alert" }
                },
                "media": {
                    "title": "Media",
                    "description": "A list of media : images, videos, etc.",
                    "type": "array",
                    "minItems": 1,
                    "items": {
                        "anyOf": [
                            { "$ref": "#/definitions/image" },
                            { "$ref": "#/definitions/youtube" }
                        ]
                    }
                },
                "inputs": {
                    "title": "Inputs",
                    "description": "List of components, tools or files required to achieve this step.",
                    "type": "array",
                    "minItems": 1,
                    "items": {
                        "anyOf": [
                            { "$ref": "#/definitions/component" },
                            { "$ref": "#/definitions/tool" },
                            { "$ref": "#/definitions/file" }
                        ]
                    }
                },
                "outputs": {
                    "title": "Outputs",
                    "description": "List of components, tools or files created during this step.",
                    "type": "array",
                    "minItems": 1,
                    "items": {
                        "anyOf": [
                            { "$ref": "#/definitions/component" },
                            { "$ref": "#/definitions/tool" },
                            { "$ref": "#/definitions/file" }
                        ]
                    }
                }
            }
        }
    },
    "type": "object",
    "oneOf": [
        {
            "title": "JSON SCHEMA for My Workshop projects",
            "required" : ["project"],
            "additionalProperties": false,
            "properties": {
                "project": {
                    "title": "Project",
                    "description": "Root of the project description.",
                    "type": "object",
                    "required": ["full_name", "slug", "short_description", "lang", "license", "about"],
                    "properties": {
                        "full_name": {
                            "title": "Full name",
                            "type": "string"
                        },
                        "slug": {
                            "$ref": "#/definitions/slug"
                        },
                        "short_description": {
                            "title": "Short description",
                            "type": "string"
                        },
                        "lang": {
                            "title": "Lang",
                            "description": "Language code according to ISO 639-1.",
                            "type": "string",
                            "enum": ["fr", "en", "de"]
                        },
                        "license": {
                            "title": "License",
                            "description": "Open source license for this project.",
                            "type": "string",
                            "enum": [
                                "CC BY",
                                "CC BY-SA",
                                "CC BY-ND",
                                "CC BY-NC",
                                "CC BY-NC-SA",
                                "CC BY-NC-ND",
                                "GNU AGPLv3",
                                "GNU GPLv3",
                                "GNU LGPLv3",
                                "Mozilla Public License 2.0",
                                "Apache License 2.0",
                                "MIT License",
                                "The Unlicense"
                            ],
                            "default": "CC BY"
                        },
                        "about": {
                            "title": "About",
                            "description": "A brief introduction to the project.",
                            "$ref": "#/definitions/paragraph",
                            "default": "Quelques mots sur le projet : le contexte, son histoire, etc. ..."
                        },
                        "featured_images": {
                            "title": "Featured images",
                            "description": "A list of media : images, videos, etc.",
                            "type": "array",
                            "minItems": 1,
                            "items": {
                                "anyOf": [
                                    { "$ref": "#/definitions/image" },
                                    { "$ref": "#/definitions/youtube" }
                                ]
                            }
                        },
                        "status": {
                            "title": "Status",
                            "description": "State of progress of this project documentation.",
                            "type": "string",
                            "enum": [
                                "draft",
                                "published",
                                "canceled"
                            ],
                            "default": "draft"
                        },
                        "links": {
                            "title": "Links",
                            "type": "array",
                            "minItems": 1,
                            "items": { "$ref": "#/definitions/link" }
                        },
                        "contributors": {
                            "title": "Contributors",
                            "type": "array",
                            "minItems": 1,
                            "items": {
                                "$ref": "#/definitions/user",
                                "required": ["role"]
                            }
                        },
                        "steps": {
                            "title": "Steps",
                            "type": "array",
                            "minItems": 1,
                            "items": { "$ref": "#/definitions/step"}
                        }
                    }
                }
            }
        },
        {
            "title": "JSON SCHEMA for My Workshop components",
            "required" : ["component"],
            "additionalProperties": false,
            "properties": {
                "component": {
                    "title": "Component",
                    "description": "Root of the component description.",
                    "type": "object",
                    "required": ["full_name", "short_description", "lang", "unit", "cost"],
                    "properties": {
                        "full_name": {
                            "title": "Full name",
                            "type": "string"
                        },
                        "short_description": {
                            "title": "Short description",
                            "type": "string",
                            "format": "textarea"
                        },
                        "lang": {
                            "title": "Lang",
                            "description": "Language code according to ISO 639-1.",
                            "type": "string",
                            "enum": ["fr", "en", "de"]
                        },
                        "unit": {
                            "title": "Unit",
                            "type": "string",
                            "enum": ["kg", "g", "m", "cm", "mm", "m²", "m³", "L", "1"],
                            "default": "1"
                        },
                        "cost": {
                            "title": "Cost",
                            "required": ["value", "currency"],
                            "additionalProperties": false,
                            "properties": {
                                "value": {
                                    "title": "Value",
                                    "type": "number"
                                },
                                "currency": {
                                    "title": "Currency",
                                    "description": "Currency designators according to ISO 4217",
                                    "type": "string",
                                    "enum": ["EUR", "USD", "GBP"]
                                }
                            }
                        },
                        "mass": {
                            "title": "Mass",
                            "required": ["value", "unit"],
                            "additionalProperties": false,
                            "properties": {
                                "value": {
                                    "title": "Value",
                                    "type": "number"
                                },
                                "unit": {
                                    "title": "Unit",
                                    "type": "string",
                                    "enum": ["kg", "g", "t"],
                                    "default": "kg"
                                }
                            }
                        },
                        "featured_image": {
                            "title": "Featured image",
                            "$ref": "#/definitions/image"
                        },
                        "brand": {
                            "title": "Brand",
                            "type": "string"
                        },
                        "model": {
                            "title": "Model",
                            "type": "string"
                        },
                        "links": {
                            "title": "Links",
                            "type": "array",
                            "minItems": 1,
                            "items": { "$ref": "#/definitions/link" }
                        }
                    }
                }
            }
        },
        {
            "title": "JSON SCHEMA for My Workshop tools",
            "required" : ["tool"],
            "additionalProperties": false,
            "properties": {
                "tool": {
                    "title": "Tool",
                    "description": "Root of the tool description.",
                    "type": "object",
                    "required": ["full_name", "short_description", "lang"],
                    "properties": {
                        "full_name": {
                            "title": "Full name",
                            "type": "string"
                        },
                        "short_description": {
                            "title": "Short description",
                            "type": "string",
                            "format": "textarea"
                        },
                        "lang": {
                            "title": "Lang",
                            "description": "Language code according to ISO 639-1.",
                            "type": "string",
                            "enum": ["fr", "en", "de"]
                        },
                        "brand": {
                            "title": "Brand",
                            "type": "string"
                        },
                        "model": {
                            "title": "Model",
                            "type": "string"
                        },
                        "featured_image": {
                            "title": "Featured image",
                            "$ref": "#/definitions/image"
                        },
                        "links": {
                            "title": "Links",
                            "type": "array",
                            "minItems": 1,
                            "items": { "$ref": "#/definitions/link" }
                        }
                    }
                }
            }
        }
    ]
}
